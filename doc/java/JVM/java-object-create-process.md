## Java对象创建步骤

1.  判断对象对应的类是否加载/链接/初始化
2.  为对象分配内存
    1.  **指针碰撞**: 如果堆中的内存规整(所有被使用过的内存放在一边,空闲的内存放在另外一边,中间放着一个指针作为分界点的指示器,分配内存就是把指针向空闲内存挪动一段与对象大小相等的距离)
    2.  **空闲列表**: 堆中的内存并不规整,虚拟机就必须维护一个列表,记录哪些内存块可用,分配内存时从列表中找到一块足够大的空间划分给对象实例并更新列表上的记录
    3.  **选择哪种分配方式由Java堆是否规整决定,堆是否规整取决于垃圾回收算法**
3.  处理并发安全问题
    1.  采用CAS失败重试的方式保证更新操作的原子性
    2.  TLAB
4.  初始化内存空间
    1.  将内存空间都初始化为零值,如果使用了TLAB,也可以提前到TLAB分配时顺便进行,这一步的操作保证了对象的实例字段在Java代码中可以不赋初始值就可以直接使用,使程序能访问到这些字段的数据类型对应的零值
5.  设置对象头
    1.  对象是哪个类的实例
    2.  类元数据信息
    3.  GC分代年龄信息
    4.  ...
6.  执行&lt;init&gt;方法进行初始化

